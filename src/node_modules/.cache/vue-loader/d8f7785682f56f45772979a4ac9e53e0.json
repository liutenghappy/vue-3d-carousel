{"remainingRequest":"C:\\Users\\Administrator\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\_vue-loader@15.9.6@vue-loader\\lib\\index.js??vue-loader-options!D:\\项目\\vue-3d-carousel\\src\\carousel.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\项目\\vue-3d-carousel\\src\\carousel.vue","mtime":1637164891938},{"path":"C:\\Users\\Administrator\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\_babel-loader@8.2.2@babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Administrator\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\_vue-loader@15.9.6@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJjYXJvdXNlbCIsDQogIHByb3BzOiB7DQogICAgd2lkdGg6IHsNCiAgICAgIHR5cGU6IFN0cmluZywNCiAgICAgIGRlZmF1bHQ6ICIxMDAlIg0KICAgIH0sDQogICAgaGVpZ2h0OiB7DQogICAgICB0eXBlOiBTdHJpbmcsDQogICAgICBkZWZhdWx0OiAiNDYwcHgiDQogICAgfSwNCiAgICBmYXJTY2FsZTogew0KICAgICAgLy/mnIDov5zml7bnmoTnvKnmlL4NCiAgICAgIHR5cGU6IE51bWJlciwNCiAgICAgIGRlZmF1bHQ6IDAuNQ0KICAgIH0sDQogICAgeFJhZGl1czogew0KICAgICAgdHlwZTogTnVtYmVyDQogICAgfSwNCiAgICB5UmFkaXVzOiB7DQogICAgICB0eXBlOiBOdW1iZXINCiAgICB9LA0KICAgIHNwZWVkOiB7DQogICAgICB0eXBlOiBOdW1iZXIsDQogICAgICBkZWZhdWx0OiA0DQogICAgfSwNCiAgICBhdXRvUGxheTogew0KICAgICAgdHlwZTogQm9vbGVhbiwNCiAgICAgIGRlZmF1bHQ6IGZhbHNlDQogICAgfSwNCiAgICBpbnRlcnZhbDogew0KICAgICAgdHlwZTogTnVtYmVyLA0KICAgICAgZGVmYXVsdDogMzAwMA0KICAgIH0sDQogICAgaXNNb3Rpb246IHsNCiAgICAgIHR5cGU6IEJvb2xlYW4sDQogICAgICBkZWZhdWx0OiBmYWxzZQ0KICAgIH0NCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgY291bnQ6IDAsDQogICAgICBpdGVtczogW10sDQogICAgICByb3RhdGlvbjogTWF0aC5QSSAvIDIsDQogICAgICBkZXN0Um90YXRpb246IE1hdGguUEkgLyAyLA0KICAgICAgbGFzdFRpbWU6IERhdGUubm93KCksDQogICAgICB0aW1lcjogMCwNCiAgICAgIGF1dG9QbGF5VGltZXI6IG51bGwsDQogICAgICB1bmlmb3JtTW90aW9uVGltZXI6IG51bGwsDQogICAgICBpbmRleDogMA0KICAgIH07DQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgc3R5bGVPYmooKSB7DQogICAgICByZXR1cm4gew0KICAgICAgICB3aWR0aDogdGhpcy53aWR0aCwNCiAgICAgICAgaGVpZ2h0OiB0aGlzLmhlaWdodA0KICAgICAgfTsNCiAgICB9LA0KICAgIHlSKCkgew0KICAgICAgcmV0dXJuIHRoaXMueVJhZGl1cyB8fCB0aGlzLiRlbC5vZmZzZXRIZWlnaHQgLyA2Ow0KICAgIH0sDQogICAgeFIoKSB7DQogICAgICByZXR1cm4gdGhpcy54UmFkaXVzIHx8IHRoaXMuJGVsLm9mZnNldFdpZHRoIC8gMi4zOw0KICAgIH0sDQogICAgeE9yaWdpbigpIHsNCiAgICAgIHJldHVybiB0aGlzLiRlbC5vZmZzZXRXaWR0aCAvIDI7DQogICAgfSwNCiAgICB5T3JpZ2luKCkgew0KICAgICAgcmV0dXJuIHRoaXMuJGVsLm9mZnNldEhlaWdodCAvIDEwOw0KICAgIH0sDQogICAgYWN0aXZlSW5kZXgoKSB7DQogICAgICByZXR1cm4gTWF0aC5yb3VuZCh0aGlzLmZsb2F0SW5kZXgoKSkgJSB0aGlzLmNvdW50Ow0KICAgIH0NCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICB0aGlzLmluaXRJdGVtKCk7DQogICAgaWYgKHRoaXMuYXV0b1BsYXkpIHRoaXMuc3RhcnQoKTsNCiAgICB0aGlzLnVuaWZvcm1Nb3Rpb24oKTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGluaXRJdGVtKCkgew0KICAgICAgLy8gICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICBsZXQgcmFkaWFucyA9IHRoaXMucm90YXRpb247DQogICAgICB0aGlzLmNvdW50ID0gdGhpcy5pdGVtcy5sZW5ndGg7DQogICAgICBsZXQgc3BhY2UgPSAoMiAqIE1hdGguUEkpIC8gdGhpcy5jb3VudDsNCiAgICAgIHRoaXMuaXRlbXMuZm9yRWFjaChlbGUgPT4gew0KICAgICAgICBlbGUucm90YXRpb24gPSByYWRpYW5zOw0KICAgICAgICBlbGUucmVuZGVySXRlbSgpOw0KICAgICAgICByYWRpYW5zICs9IHNwYWNlOw0KICAgICAgfSk7DQogICAgICAvLyAgIH0pOw0KICAgIH0sDQogICAgc2NoZWR1bGVOZXh0RnJhbWUoKSB7DQogICAgICB0aGlzLmxhc3RUaW1lID0gRGF0ZS5ub3coKTsNCiAgICAgIHRoaXMudGltZXIgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMucGxheUZyYW1lKTsNCiAgICB9LA0KICAgIHBsYXkoKSB7DQogICAgICBpZiAodGhpcy50aW1lciA9PT0gMCkgew0KICAgICAgICB0aGlzLnNjaGVkdWxlTmV4dEZyYW1lKCk7DQogICAgICB9DQogICAgfSwNCiAgICBwbGF5RnJhbWUoKSB7DQogICAgICB2YXIgcmVtID0gdGhpcy5kZXN0Um90YXRpb24gLSB0aGlzLnJvdGF0aW9uOw0KICAgICAgdmFyIG5vdyA9IERhdGUubm93KCk7DQogICAgICB2YXIgZHQgPSAobm93IC0gdGhpcy5sYXN0VGltZSkgKiAwLjAwMjsNCiAgICAgIHRoaXMubGFzdFRpbWUgPSBub3c7DQogICAgICBpZiAoTWF0aC5hYnMocmVtKSA8IDAuMDA1KSB7DQogICAgICAgIHRoaXMucm90YXRpb24gPSB0aGlzLmRlc3RSb3RhdGlvbjsNCiAgICAgICAgdGhpcy51bmlmb3JtTW90aW9uKCk7DQoNCiAgICAgICAgdGhpcy5wYXVzZSgpOw0KICAgICAgICB0aGlzLiRlbWl0KCJjaGFuZ2UiLCB0aGlzLmFjdGl2ZUluZGV4KTsNCiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm9uQW5pbWF0aW9uRmluaXNoZWQgPT09ICJmdW5jdGlvbiIpDQogICAgICAgICAgdGhpcy5vbkFuaW1hdGlvbkZpbmlzaGVkKCk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICAvLyDmuJDov5HlnLDmjqXov5Hnm67moIcNCiAgICAgICAgdGhpcy5yb3RhdGlvbiA9IHRoaXMuZGVzdFJvdGF0aW9uIC0gcmVtIC8gKDEgKyB0aGlzLnNwZWVkICogZHQpOw0KICAgICAgICB0aGlzLnNjaGVkdWxlTmV4dEZyYW1lKCk7DQogICAgICB9DQoNCiAgICAgIHRoaXMuaW5pdEl0ZW0oKTsNCiAgICB9LA0KICAgIHBhdXNlKCkgew0KICAgICAgY29uc29sZS5sb2coIuaaguWBnCIpOw0KICAgICAgd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMudGltZXIpOw0KICAgICAgdGhpcy50aW1lciA9IDA7DQogICAgfSwNCiAgICBnbyhjb3VudCkgew0KICAgICAgdGhpcy5kZXN0Um90YXRpb24gKz0gKCgyICogTWF0aC5QSSkgLyB0aGlzLmNvdW50KSAqIGNvdW50Ow0KICAgICAgdGhpcy5wbGF5KCk7DQogICAgfSwNCiAgICBnb1RvKGluZGV4KSB7DQogICAgICB0aGlzLnN0b3BNb3Rpb24oKTsNCiAgICAgIHRoaXMuc3RvcCgpOw0KICAgICAgLy/mib7liLDlsIbpobnnm67ml4vovazliLDliY3pnaLnmoTmnIDnn63mlrnms5UNCiAgICAgIGxldCBkaWZmID0gaW5kZXggLSAodGhpcy5mbG9hdEluZGV4KCkgJSB0aGlzLmNvdW50KTsNCg0KICAgICAgaWYgKDIgKiBNYXRoLmFicyhkaWZmKSA+IHRoaXMuY291bnQpDQogICAgICAgIGRpZmYgLT0gZGlmZiA+IDAgPyB0aGlzLmNvdW50IDogLXRoaXMuY291bnQ7DQoNCiAgICAgIC8vIOWBnOatouS7u+S9leato+WcqOi/m+ihjOeahOaXi+i9rA0KICAgICAgdGhpcy5kZXN0Um90YXRpb24gPSB0aGlzLnJvdGF0aW9uOw0KDQogICAgICAvLyDml4vovaznm7jlj43nmoTmlrnlkJHmiorpobnnm67luKbliLDliY3pnaINCiAgICAgIHRoaXMuZ28oLWRpZmYpOw0KDQogICAgICAvLyDov5Tlm57liLDnm67moIfnmoTml4vovazot53nprso5Lul6aG555uu5Li65Y2V5L2NKQ0KICAgICAgcmV0dXJuIGRpZmY7DQogICAgfSwNCiAgICBpdGVtc1JvdGF0ZWQoKSB7DQogICAgICByZXR1cm4gKHRoaXMuY291bnQgKiAoTWF0aC5QSSAvIDIgLSB0aGlzLnJvdGF0aW9uKSkgLyAoMiAqIE1hdGguUEkpOw0KICAgIH0sDQogICAgZmxvYXRJbmRleCgpIHsNCiAgICAgIGxldCBmbG9hdEluZGV4ID0gdGhpcy5pdGVtc1JvdGF0ZWQoKSAlIHRoaXMuY291bnQ7DQoNCiAgICAgIC8vIOehruS/nWZsb2F0LWluZGV45piv5q2j55qEDQogICAgICByZXR1cm4gZmxvYXRJbmRleCA8IDAgPyBmbG9hdEluZGV4ICsgdGhpcy5jb3VudCA6IGZsb2F0SW5kZXg7DQogICAgfSwNCiAgICBzdGFydCgpIHsNCiAgICAgIHRoaXMuYXV0b1BsYXlUaW1lciA9IHNldEludGVydmFsKCgpID0+IHsNCiAgICAgICAgdGhpcy5nbygxKTsNCiAgICAgIH0sIHRoaXMuaW50ZXJ2YWwpOw0KICAgIH0sDQogICAgc3RvcCgpIHsNCiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5hdXRvUGxheVRpbWVyKTsNCiAgICB9LA0KICAgIHVuaWZvcm1Nb3Rpb24oKSB7DQogICAgICBpZiAodGhpcy5hY3RpdmVJbmRleCAhPSB0aGlzLmluZGV4KSB7DQogICAgICAgIHRoaXMuaW5kZXggPSB0aGlzLmFjdGl2ZUluZGV4Ow0KICAgICAgICB0aGlzLiRlbWl0KCJjaGFuZ2UiLCB0aGlzLmluZGV4KTsNCiAgICAgIH0NCg0KICAgICAgdGhpcy5yb3RhdGlvbiArPSAwLjAwNTsNCiAgICAgIHRoaXMuaW5pdEl0ZW0oKTsNCiAgICAgIHRoaXMudW5pZm9ybU1vdGlvblRpbWVyID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSgNCiAgICAgICAgdGhpcy51bmlmb3JtTW90aW9uDQogICAgICApOw0KICAgIH0sDQogICAgc3RvcE1vdGlvbigpIHsNCiAgICAgIHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLnVuaWZvcm1Nb3Rpb25UaW1lcik7DQogICAgfQ0KICB9LA0KDQogIGNvbXBvbmVudHM6IHt9LA0KICBiZWZvcmVEZXN0cm95KCkge30NCn07DQo="},{"version":3,"sources":["carousel.vue"],"names":[],"mappings":";;;;;;;;;;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"carousel.vue","sourceRoot":".","sourcesContent":["<template>\r\n  <div\r\n    :style=\"styleObj\"\r\n    id=\"carousel\"\r\n  >\r\n    <slot></slot>\r\n  </div>\r\n</template>\r\n\r\n<script type=\"text/javascript\">\r\nexport default {\r\n  name: \"carousel\",\r\n  props: {\r\n    width: {\r\n      type: String,\r\n      default: \"100%\"\r\n    },\r\n    height: {\r\n      type: String,\r\n      default: \"460px\"\r\n    },\r\n    farScale: {\r\n      //最远时的缩放\r\n      type: Number,\r\n      default: 0.5\r\n    },\r\n    xRadius: {\r\n      type: Number\r\n    },\r\n    yRadius: {\r\n      type: Number\r\n    },\r\n    speed: {\r\n      type: Number,\r\n      default: 4\r\n    },\r\n    autoPlay: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    interval: {\r\n      type: Number,\r\n      default: 3000\r\n    },\r\n    isMotion: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      count: 0,\r\n      items: [],\r\n      rotation: Math.PI / 2,\r\n      destRotation: Math.PI / 2,\r\n      lastTime: Date.now(),\r\n      timer: 0,\r\n      autoPlayTimer: null,\r\n      uniformMotionTimer: null,\r\n      index: 0\r\n    };\r\n  },\r\n  computed: {\r\n    styleObj() {\r\n      return {\r\n        width: this.width,\r\n        height: this.height\r\n      };\r\n    },\r\n    yR() {\r\n      return this.yRadius || this.$el.offsetHeight / 6;\r\n    },\r\n    xR() {\r\n      return this.xRadius || this.$el.offsetWidth / 2.3;\r\n    },\r\n    xOrigin() {\r\n      return this.$el.offsetWidth / 2;\r\n    },\r\n    yOrigin() {\r\n      return this.$el.offsetHeight / 10;\r\n    },\r\n    activeIndex() {\r\n      return Math.round(this.floatIndex()) % this.count;\r\n    }\r\n  },\r\n  mounted() {\r\n    this.initItem();\r\n    if (this.autoPlay) this.start();\r\n    this.uniformMotion();\r\n  },\r\n  methods: {\r\n    initItem() {\r\n      //   this.$nextTick(() => {\r\n      let radians = this.rotation;\r\n      this.count = this.items.length;\r\n      let space = (2 * Math.PI) / this.count;\r\n      this.items.forEach(ele => {\r\n        ele.rotation = radians;\r\n        ele.renderItem();\r\n        radians += space;\r\n      });\r\n      //   });\r\n    },\r\n    scheduleNextFrame() {\r\n      this.lastTime = Date.now();\r\n      this.timer = window.requestAnimationFrame(this.playFrame);\r\n    },\r\n    play() {\r\n      if (this.timer === 0) {\r\n        this.scheduleNextFrame();\r\n      }\r\n    },\r\n    playFrame() {\r\n      var rem = this.destRotation - this.rotation;\r\n      var now = Date.now();\r\n      var dt = (now - this.lastTime) * 0.002;\r\n      this.lastTime = now;\r\n      if (Math.abs(rem) < 0.005) {\r\n        this.rotation = this.destRotation;\r\n        this.uniformMotion();\r\n\r\n        this.pause();\r\n        this.$emit(\"change\", this.activeIndex);\r\n        if (typeof this.onAnimationFinished === \"function\")\r\n          this.onAnimationFinished();\r\n      } else {\r\n        // 渐近地接近目标\r\n        this.rotation = this.destRotation - rem / (1 + this.speed * dt);\r\n        this.scheduleNextFrame();\r\n      }\r\n\r\n      this.initItem();\r\n    },\r\n    pause() {\r\n      console.log(\"暂停\");\r\n      window.cancelAnimationFrame(this.timer);\r\n      this.timer = 0;\r\n    },\r\n    go(count) {\r\n      this.destRotation += ((2 * Math.PI) / this.count) * count;\r\n      this.play();\r\n    },\r\n    goTo(index) {\r\n      this.stopMotion();\r\n      this.stop();\r\n      //找到将项目旋转到前面的最短方法\r\n      let diff = index - (this.floatIndex() % this.count);\r\n\r\n      if (2 * Math.abs(diff) > this.count)\r\n        diff -= diff > 0 ? this.count : -this.count;\r\n\r\n      // 停止任何正在进行的旋转\r\n      this.destRotation = this.rotation;\r\n\r\n      // 旋转相反的方向把项目带到前面\r\n      this.go(-diff);\r\n\r\n      // 返回到目标的旋转距离(以项目为单位)\r\n      return diff;\r\n    },\r\n    itemsRotated() {\r\n      return (this.count * (Math.PI / 2 - this.rotation)) / (2 * Math.PI);\r\n    },\r\n    floatIndex() {\r\n      let floatIndex = this.itemsRotated() % this.count;\r\n\r\n      // 确保float-index是正的\r\n      return floatIndex < 0 ? floatIndex + this.count : floatIndex;\r\n    },\r\n    start() {\r\n      this.autoPlayTimer = setInterval(() => {\r\n        this.go(1);\r\n      }, this.interval);\r\n    },\r\n    stop() {\r\n      clearInterval(this.autoPlayTimer);\r\n    },\r\n    uniformMotion() {\r\n      if (this.activeIndex != this.index) {\r\n        this.index = this.activeIndex;\r\n        this.$emit(\"change\", this.index);\r\n      }\r\n\r\n      this.rotation += 0.005;\r\n      this.initItem();\r\n      this.uniformMotionTimer = window.requestAnimationFrame(\r\n        this.uniformMotion\r\n      );\r\n    },\r\n    stopMotion() {\r\n      window.cancelAnimationFrame(this.uniformMotionTimer);\r\n    }\r\n  },\r\n\r\n  components: {},\r\n  beforeDestroy() {}\r\n};\r\n</script>\r\n\r\n<style lang=\"css\" scoped>\r\n</style>\r\n"]}]}